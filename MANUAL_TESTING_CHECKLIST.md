# QXB 代币项目 - 手工验收清单

本文档提供了关键功能的手工验收测试步骤，用于验证系统是否正常工作。

## 前置条件

1. ✅ 后端 API 服务器运行在 `http://localhost:8080`
2. ✅ 前端应用运行在 `http://localhost:3000`
3. ✅ 已编译合约（`forge build`）
4. ✅ 合约已部署到 Sepolia 测试网

## 1. 用户注册流程

### 测试步骤

1. 打开浏览器访问 `http://localhost:3000`
2. 点击"立即注册"或访问 `/register`
3. 填写注册表单：
   - 邮箱：`test-user-1@example.com`
   - 密码：`TestPassword123!`
   - 确认密码：`TestPassword123!`
4. 点击"注册"按钮

### 预期结果

- ✅ 注册成功，自动跳转到 Dashboard
- ✅ 显示生成的以太坊地址（格式：`0x...`）
- ✅ 显示代币余额（初始可能为 0）
- ✅ 显示每日奖励状态
- ✅ 浏览器 localStorage 中存储了 JWT token

### 验证点

- [ ] 地址格式正确（42 字符，以 0x 开头）
- [ ] 地址在 Etherscan 上可以查询到
- [ ] 注册后可以立即使用该地址进行代币操作

---

## 2. 用户登录流程

### 测试步骤

1. 如果已登录，先点击"退出"按钮
2. 访问 `/login` 页面
3. 填写登录表单：
   - 邮箱：使用注册时使用的邮箱
   - 密码：使用注册时的密码
4. 点击"登录"按钮

### 预期结果

- ✅ 登录成功，跳转到 Dashboard
- ✅ 显示用户邮箱和地址
- ✅ 显示代币余额和奖励状态

### 验证点

- [ ] 使用错误密码无法登录
- [ ] 使用不存在的邮箱无法登录
- [ ] 登录后可以正常访问 Dashboard

---

## 3. 每日奖励领取

### 测试步骤

1. 登录账户
2. 在 Dashboard 页面查看"每日奖励"卡片
3. 如果显示"✅ 可以领取"：
   - 点击"领取奖励"按钮
   - 输入账户密码
   - 点击"确认领取"
4. 等待交易确认（可能需要几秒到几分钟）

### 预期结果

- ✅ 显示成功提示，包含交易哈希
- ✅ 奖励状态更新为"⏳ 今日已领取"
- ✅ 代币余额增加 1 QXB（等待交易确认后）
- ✅ 在 Etherscan 上可以查看交易详情

### 验证点

- [ ] 使用错误密码无法领取
- [ ] 今日已领取后，再次点击显示"今日已领取"
- [ ] 交易哈希可以在 Etherscan 上查询到
- [ ] 交易成功后余额正确增加

---

## 4. 代币转账

### 测试步骤

1. 准备两个账户：
   - 账户A：有代币余额的账户
   - 账户B：接收代币的账户
2. 使用账户A登录
3. 在 Dashboard 页面找到"转账"卡片
4. 填写转账表单：
   - 接收地址：账户B的地址
   - 金额：`1`（表示 1 QXB）
   - 密码：账户A的密码
5. 点击"转账"按钮
6. 等待交易确认
7. 切换到账户B登录，查看余额变化

### 预期结果

- ✅ 显示成功提示，包含交易哈希
- ✅ 账户A余额减少 1 QXB
- ✅ 账户B余额增加 1 QXB
- ✅ 在 Etherscan 上可以查看转账交易

### 验证点

- [ ] 余额不足时无法转账（显示错误提示）
- [ ] 使用错误密码无法转账
- [ ] 无效地址无法转账
- [ ] 转账给自己时的处理（如果后端有验证）
- [ ] 交易哈希可以在 Etherscan 上查询到
- [ ] 双方余额变化正确

---

## 5. 错误场景测试

### 5.1 错误密码登录

1. 访问登录页面
2. 输入正确的邮箱和错误的密码
3. 点击登录

**预期结果**：显示错误提示"邮箱或密码错误"

### 5.2 余额不足转账

1. 登录账户
2. 查看当前余额
3. 尝试转账超过余额的金额

**预期结果**：显示错误提示"余额不足"

### 5.3 未登录访问

1. 清除浏览器 localStorage（或使用隐私模式）
2. 直接访问 `http://localhost:3000/dashboard`

**预期结果**：自动重定向到登录页面

### 5.4 无效地址转账

1. 登录账户
2. 在转账表单中输入无效地址（如 `0xinvalid`）
3. 填写金额和密码
4. 点击转账

**预期结果**：显示错误提示"无效的接收地址"

### 5.5 错误密码领取奖励

1. 登录账户
2. 点击"领取奖励"
3. 输入错误的密码
4. 点击"确认领取"

**预期结果**：显示错误提示"密码错误或解密失败"

---

## 6. 数据持久化验证

### 测试步骤

1. 注册一个新账户
2. 记录邮箱、密码和地址
3. 关闭浏览器
4. 重新打开浏览器
5. 使用记录的邮箱和密码登录

### 预期结果

- ✅ 可以成功登录
- ✅ 显示相同的地址
- ✅ 余额和奖励状态正确

### 验证点

- [ ] 数据库文件 `data/qxb.db` 存在
- [ ] 用户信息已正确存储
- [ ] 私钥已加密存储（无法直接读取）

---

## 7. API 端点验证

### 使用 curl 测试 API

#### 7.1 注册用户

```bash
curl -X POST http://localhost:8080/api/auth/register \
  -H "Content-Type: application/json" \
  -d '{"email":"test@example.com","password":"Test123!"}'
```

**预期结果**：返回用户信息和 JWT token

#### 7.2 登录

```bash
curl -X POST http://localhost:8080/api/auth/login \
  -H "Content-Type: application/json" \
  -d '{"email":"test@example.com","password":"Test123!"}'
```

**预期结果**：返回用户信息和 JWT token

#### 7.3 获取用户信息（需要认证）

```bash
curl -X GET http://localhost:8080/api/auth/me \
  -H "Authorization: Bearer <你的JWT令牌>"
```

**预期结果**：返回当前用户信息

#### 7.4 查询余额

```bash
curl http://localhost:8080/api/token/balance/0x你的地址
```

**预期结果**：返回余额信息

#### 7.5 查询奖励状态

```bash
curl http://localhost:8080/api/reward/status/0x你的地址
```

**预期结果**：返回奖励状态信息

---

## 8. 安全验证

### 8.1 私钥加密存储

1. 使用数据库工具打开 `data/qxb.db`
2. 查询 `users` 表
3. 检查 `enc_priv_key` 字段

**预期结果**：
- ✅ 私钥以加密形式存储（base64 编码的密文）
- ✅ 无法直接读取私钥明文
- ✅ 每个用户有不同的 `enc_salt`

### 8.2 JWT Token 验证

1. 登录后，从浏览器开发者工具查看 localStorage
2. 复制 JWT token
3. 使用在线工具解码（如 jwt.io）

**预期结果**：
- ✅ Token 包含 user_id 和 email
- ✅ Token 有过期时间（24小时）
- ✅ 无法直接获取私钥信息

---

## 9. 性能测试

### 9.1 页面加载速度

1. 打开浏览器开发者工具（Network 标签）
2. 访问各个页面
3. 记录加载时间

**预期结果**：
- ✅ 页面加载时间 < 3 秒
- ✅ API 请求响应时间 < 1 秒

### 9.2 并发操作

1. 打开多个浏览器标签页
2. 同时进行多个操作（登录、查询余额等）

**预期结果**：
- ✅ 所有操作都能正常完成
- ✅ 没有数据冲突

---

## 10. 浏览器兼容性

### 测试浏览器

- [ ] Chrome（最新版本）
- [ ] Firefox（最新版本）
- [ ] Safari（最新版本）
- [ ] Edge（最新版本）

**预期结果**：所有浏览器都能正常使用

---

## 验收标准

所有测试项目通过后，可以认为系统已准备好投入使用。

### 关键验收点

1. ✅ 用户可以成功注册和登录
2. ✅ 私钥安全加密存储
3. ✅ 可以成功领取每日奖励
4. ✅ 可以成功进行代币转账
5. ✅ 错误场景正确处理
6. ✅ 数据持久化正常
7. ✅ API 端点正常工作
8. ✅ 安全机制有效

---

## 已知问题和限制

1. **链上交易确认时间**：转账和领取奖励需要等待链上确认，可能需要几秒到几分钟
2. **测试网限制**：Sepolia 测试网可能有速率限制
3. **Gas 费用**：需要 Sepolia ETH 来支付 Gas 费用

---

## 测试环境

- **后端**: Go 1.21+
- **前端**: React 19, TypeScript
- **数据库**: SQLite 3
- **区块链**: Ethereum Sepolia 测试网
- **合约地址**: `0xFF96cF72Cc4FCb67C61e0E43924723fA88765A06`

---

最后更新：2024年




